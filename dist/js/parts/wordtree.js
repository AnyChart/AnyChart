if(!_.wordtree){_.wordtree=1;(function($){var C3=function(){$.Hp.call(this);$.R(this.ya,eha)},D3=function(a,b){$.qv.call(this);$.rs(this,this,this.Uf,this.Ag,this.dC,this.Uf,null,null);this.Kq=null;this.Mt=[];this.xL=[];this.sM=this.OJ=null;this.Nf=[];this.QH=[];$.R(this.ya,[["minFontSize",4,1],["maxFontSize",4,1],["postfix",4,1],["fontFamily",4,1],["fontStyle",16,1],["fontWeight",4,1],["fontColor",16,1],["fontOpacity",16,1],["fontDecoration",16,1]]);this.data(a,b)},E3=function(a,b){var c=b.getParent();if(c){for(var d=0;d<c.Ub();d++){var e=
c.Gd(d);e!=b&&e.j("hidden",!0)}E3(a,c)}},F3=function(a){for(var b=0;b<a.xL.length;b++)a.xL[b].j("hidden",!1)},G3=function(a,b,c){if(c.length){for(var d=b.al(),e=!1,f=0;f<b.Ub();f++)if(d[f].get("value")==c[0]){e=!0;break}e?(c.shift(),b=d[f]):(b=b.fc({value:c[0]}),c.shift());return G3(a,b,c)}return b},fha=function(a){a=a.split(/\s*(.+?(?:[?!]+|$|\.(?=\s+[A-Z]|$)))\s*/);return a=(0,$.ve)(a,function(a){return!!a.length})},H3=function(a){a=a.split(/([!?,;:.&"-]+|\S*[A-Z]\.|\S*(?:[^!?,;:.\s&-]))/);return a=
(0,$.ve)(a,function(a){return a.length&&" "!=a})},I3=function(a,b){null!=a.qa&&($.Jp(a.qa,a.Td,a),a.qa.Xc());a.qa=b;$.U(a.qa,a.Td,a);a.u(4100,1)},J3=function(a,b,c){if(b){var d=b.get("fontSize");if(null==d){if((d=b.getParent())&&(1==d.Ub()||c))return d=J3(a,d,c),b.j("fontSize",d),d;c=a.i("maxFontSize");a=a.i("minFontSize");d=b.j("height")/1.5;d=$.Xa(d,a,c);b.j("fontSize",d)}return d}return 0},K3=function(a,b){if(b){var c=b.Ub(),d=0;if(c)for(var e=0;e<c;e++)d+=K3(a,b.Gd(e));else d=b.get("weight")||
1;b.j("leafCount",d).j("weight",d);return d}return 0},L3=function(a,b,c){var d=0,e=b.getParent();e&&1<e.Ub()&&(d+=a.Vk().i("offset"));var f=b.get("value");1==b.Ub()&&(f+=" ");d=b.j("nodePositionX")+d;e=b.j("nodePositionY");var h=b.get("fontFamily")||a.i("fontFamily");var k=b.get("fontWeight")||a.i("fontWeight");c=J3(a,b,c);f=a.Lw(d,e,f,c,h,k);f.tag={node:b,type:"node",f_:!1};h=f.NF();c=f.uR();b.j("textHeight",h).j("textWidth",c);e-=h/2;b=d+c;a=a.Oj.$a();b>a&&f.width(c-(b-a)-.05*c);f.x(d).y(e)},M3=
function(a,b,c,d,e,f){if(b){b.j("connectorInXPosition",c[0]).j("connectorInYPosition",c[1]).j("connectorOutXPosition",c[0]+a.uT(b)).j("connectorOutYPosition",c[1]);var h=a.Oj.$a();if(d<h){c=a.Vk();var k=b.Ub(),l=c.i("length"),m=c.i("offset");c=c.i("curveFactor");var p=a.i("minFontSize");if(k){if(1<k){var q=p/10;e+=q;f-=q}q=e;for(var r=!1,t,u=0;u<k;u++)if(t=b.Gd(u),t.j("hidden")){r=!0;break}if((f-e)/k<1.5*p&&1<k){k="+"+b.j("leafCount")+" "+a.i("postfix");var v=(f+e)/2;m=d;d=a.Lw(m,v,k,b.j("fontSize")||
p,a.i("fontFamily"),a.i("fontWeight"));v-=d.NF()/2;d.y(v);d.tag.node=b;d.tag.f_=!0;k=d.uR();m+k>=h&&d.visible(!1);a.zB(b.j("connectorOutXPosition"),b.j("connectorOutYPosition"),b.j("connectorOutXPosition")+20,(f+e)/2,c)}else for(r&&(d-=l+m),u=0;u<k;u++)if(t=b.Gd(u),!t.j("hidden")){m=t.j("leafCount");h=b.j("leafCount");h=r?f-e:(f-e)*Math.max(1,m)/Math.max(1,h);p=q;var w=0;q=p+h;m=d;v=p+h/2;var x=[m,v];t.j("height",h).j("nodePositionX",m).j("nodePositionY",v);L3(a,t,r);v=b.j("textHeight")/2;x[1]-=v;
1!=t.Ub()&&(w+=l);m=a.uT(t);v=[x[0],x[1]+v];w+=x[0]+m;M3(a,t,v,w,p,p+h);1<b.Ub()&&!r&&a.zB(b.j("connectorOutXPosition"),b.j("connectorOutYPosition"),t.j("connectorInXPosition"),t.j("connectorInYPosition"),c)}}}}},N3=function(a,b){var c=new D3(a,b);c.Ta("wordtree");return c};$.I(C3,$.Hp);var O3={};$.Po(O3,[[0,"curveFactor",$.Cp],[0,"offset",$.zp],[0,"length",$.zp],[1,"stroke",$.lp]]);$.T(C3,O3);C3.prototype.ra=8201;var eha=[["curveFactor",0,8],["offset",0,8],["length",0,8],["stroke",0,8192]];
C3.prototype.F=function(){var a=C3.B.F.call(this);$.pp(this,O3,a);return a};C3.prototype.$=function(a,b){C3.B.$.call(this,a,b);$.dp(this,O3,a,b)};$.I(D3,$.qv);D3.prototype.ra=$.qv.prototype.ra;D3.prototype.pa=$.qv.prototype.pa|4112;var P3=function(){var a={};$.Po(a,[[0,"minFontSize",$.zp],[0,"maxFontSize",$.zp],[0,"fontFamily",$.Vo],[0,"fontStyle",$.Hj],[0,"fontWeight",$.To],[0,"fontColor",$.Wo],[0,"fontOpacity",$.Xo],[0,"fontDecoration",$.Gj],[0,"postfix",function(a){if($.n(a))return null===a&&(a=this.gh("postfix")),String(a)}]]);return a}();$.T(D3,P3);$.g=D3.prototype;$.g.Ra=function(){return"wordtree"};
$.g.cj=function(){return!(this.qa&&(!this.qa||this.qa.Ub()))};$.g.Ie=function(){return[]};$.g.Ru=function(){return[this]};$.g.rS=function(a,b){return function(c){return a*(1-c)+b*c}};$.g.gk=function(a,b){return $.ps(this.data(),b)};$.g.Vk=function(a){this.nr||(this.nr=new C3,$.Tp(this,"connectors",this.nr),$.U(this.nr,this.kea,this));return a?(this.nr.N(a),this):this.nr};
$.g.KP=function(a){this.Wk||(this.Wk=new $.Cu);var b={};a&&(b.value={value:a.get("value"),type:"string"},b.weight={value:a.j("weight"),type:"number"});this.Wk.ng(a);return $.nt(this.Wk,b)};$.g.fq=function(a){if(a){"array"==$.ja(a)&&(a=a[0]);if(!$.L(a,$.cs)&&(a=this.data().Eo("value",a)[0],!a))return;this.OJ=a;E3(this,a);this.u(20,1)}};$.g.Mw=function(){F3(this);this.OJ&&this.OJ.getParent()&&this.fq(this.OJ.getParent());return this};
$.g.kea=function(a){var b=0;$.W(a,8192)&&(b|=16);$.W(a,8)&&(b|=4);this.u(b,1)};$.g.Td=function(a){$.W(a,16)&&this.u(4100,9)};$.g.dC=function(a){a.button==$.ii&&(a=a.domTarget.tag)&&a.node&&(F3(this),this.fq(a.node))};$.g.Uf=function(a){var b=a.domTarget.tag;if(b&&b.node&&!b.f_){var c=b.node;b=this.ab();$.Lu(b,a.clientX,a.clientY,this.KP(c))}else this.ab().gd()};$.g.Ag=function(){this.ab().gd()};
$.g.oV=function(a){if("implicit"==this.ed){if($.n(a)){if(this.sM!=a||this.MY){this.MY=!1;if(null===a||/^[\s\xa0]*$/.test(a))a=this.jv[0][0];this.sM=a;for(var b=[],c=0;c<this.jv.length;c++){var d=(0,$.wa)(this.jv[c],a);-1!=d&&b.push($.Ha(this.jv[c],d))}b.length||(b[0]=[a]);a=b[0][0];$.V(this.data());this.data().Ub()&&this.data().Gi(0);c={value:a};c=this.data().Qf(c,0);for(d=0;d<b.length;d++){var e=b[d];e[0]==a&&(e.shift(),G3(this,c,e))}this.data().ba(!0)}return this}return this.sM}return this};
$.g.data=function(a,b){if($.n(a)){if($.L(a,$.$r)||$.L(a,$.Yr))this.qa!=a&&(this.qa&&$.Jp(this.qa,this.Td,this),this.qa=a,$.U(this.qa,this.Td,this),this.ed="explicit",this.u(4100,1));else if("array"==$.ja(a)&&"object"==$.ja(a[0]))this.data($.ns(a,b));else if(null===a)this.qa&&($.Jp(this.qa,this.Td),this.qa.Xc()),this.qa=null,this.u(4100,1);else{this.ed="implicit";this.Nf=a;if("array"==$.ja(a)&&a.length)if(this.jv=[],"array"==$.ja(a[0]))for(var c=0;c<a.length;c++)this.jv.push(H3(a[c][0]));else{if("string"==
$.ja(a[0]))for(c=0;c<a.length;c++)this.jv.push(H3(a[c]))}else if("string"==$.ja(a)){c=fha(a);for(var d=[],e=0;e<c.length;e++)d.push(H3(c[e]));this.jv=d}else this.jv=[[a.toString()]];this.qa||I3(this,$.ns());this.MY=!0;this.oV(this.jv[0][0])}return this}return this.qa};$.g.qh=function(){var a;0<this.QH.length?a=this.QH.pop():a=new $.dh;return a};$.g.uT=function(a){if(a){var b=a.j("textWidth"),c=this.Vk().i("offset"),d=a.getParent();d&&1<d.Ub()&&(b+=c);1<a.Ub()&&(b+=c);return b}return 0};
$.g.depth=function(a){if(a){var b=a.Ub(),c=0,d=a.getParent();d&&(c=d.j("depth")+1);a.j("depth",c);for(c=0;c<b;c++)this.depth(a.Gd(c))}};$.g.Lw=function(a,b,c,d,e,f){var h=this.qh();h.tag||(h.tag={});h.text(c);h.y(b);h.x(a);h.fontSize(d);h.fontFamily(e);h.fontWeight(f);h.width(null);h.visible(!0);this.Mt.push(h);return h};$.g.zB=function(a,b,c,d,e){var f=this.pB,h=this.rS(a,c),k=h(e);e=h(1-e);f.moveTo(a,b).Rj(k,b,e,d,c,d)};
$.g.Ui=function(a){if(!this.Lf())if(this.wa||(this.wa=this.Va.ke(),this.pB=new $.Uf,this.wa.zIndex(30)),this.cj())this.wa.wi();else{var b=this.Kq=this.qa.Gd(0);this.J(4096)&&(K3(this,this.Kq),this.depth(this.Kq),this.xL.length=0,this.xL=this.data().Yu().aB(),this.I(4096));if(this.J(4)){this.wa.wi();var c=a.left;var d=a.top;a=a.height;for(var e=this.Vk(),f=e.i("offset"),h=0;h<this.Mt.length;h++){var k=this.Mt[h];this.QH.push(k)}this.Mt.length=0;this.pB.clear();this.wa.suspend();k=[c+f,d+a/2];b.j("nodePositionX",
k[0]).j("nodePositionY",k[1]).j("height",a);L3(this,b,!1);c=c+f+this.uT(b)+(1<b.Ub()?e.i("length"):0);M3(this,b,k,c,d,d+a);this.pB.parent(this.wa);this.I(4);for(h=0;h<this.Mt.length;h++)this.Mt[h].parent(this.wa);this.wa.resume();this.u(16)}if(this.J(16)){this.wa.suspend();this.pB.stroke(this.Vk().i("stroke"));d=this.i("fontColor");c=this.i("fontDecoration");a=this.i("fontStyle");e=this.i("fontOpacity");for(f=0;f<this.Mt.length;f++){b=this.Mt[f];if(b.tag&&b.tag.node){var l=b.tag.node;var m=l.get("fontColor")||
d;var p=l.get("fontDecoration")||c;var q=l.get("fontStyle")||a;l=l.get("fontOpacity")||e}b.color(m);b.aq(p);b.fontStyle(q);b.opacity(l);b.Ml(!1)}this.wa.resume();this.I(16)}}};$.g.F=function(){var a=D3.B.F.call(this);$.pp(this,P3,a);"implicit"==this.ed&&(a.wordTreeRawData=JSON.stringify(this.Nf),a.word=this.sM);a.treeData=this.data().kA(["hidden"]);a.connectors=this.Vk().F();return{chart:a}};
$.g.$=function(a,b){D3.B.$.call(this,a,b);$.dp(this,P3,a,b);"wordTreeRawData"in a?(this.data(JSON.parse(a.wordTreeRawData)),"word"in a&&this.oV(a.word),"treeData"in a&&I3(this,$.bs(a.treeData))):"treeData"in a&&this.data($.bs(a.treeData));"connectors"in a&&this.Vk().ea(!!b,a.connectors)};$.g.R=function(){D3.B.R.call(this);$.bd(this.pB,this.Mt,this.QH,this.qa,this.wa);this.qa=this.pB=null;this.Mt.length=0;this.QH.length=0;this.wa=null};var Q3=D3.prototype;Q3.connectors=Q3.Vk;Q3.word=Q3.oV;
Q3.getType=Q3.Ra;Q3.drillTo=Q3.fq;Q3.drillUp=Q3.Mw;Q3.toCsv=Q3.gk;Q3.noData=Q3.Tm;$.oo.wordtree=N3;$.H("anychart.wordtree",N3);}).call(this,$)}
